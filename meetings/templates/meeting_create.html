{% extends "base.html" %}

{% block page-header %}
    <div class="page-header">
        <h1>Create new meeting</h1>
    </div>
{% endblock %}
{% block content %}

    <form method="post">
        {% csrf_token %}
        {{ form.non_field_errors }}

        <div>
            <label for="progress">Complitnes</label>
            <div class="progress progress-striped active">

                <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">

                </div>
            </div>
        </div>

        <div class="row">
            <div class="form-group col-md-4">
                {{ form.project.errors }}
                <label for="{{ form.message.id_for_label }}">Project</label>
                {{ form.project }}
{#                            <select name="project" class="form-control" id="meeting_project">#}
{#                                {% for project in projects %}#}
{#                                    <option value="{{ project }}">{{ project }}</option>#}
{#                                {% endfor %}#}
{#                            </select>#}
            </div>


            <div class="form-group col-md-4">
                <label for="meeting_type">Meeting type</label>
                {{ form.meeting_type }}
{#                            <select name="meeting_type" class="form-control" id="meeting_type">#}
{#                                {% for type in meetingTypes %}#}
{#                                    <option value="{{ type }}">{{ type }}</option>#}
{#                                {% endfor %}#}
{#                            </select>#}
            </div>

            <div class="form-group col-md-4">
                <label for="meeting_type">Relative meeting</label>
                {{ form.meeting_type }}
{#                            <select name="meeting_type" class="form-control" id="meeting_type">#}
{#                                {% for type in meetingTypes %}#}
{#                                    <option value="{{ type }}">{{ type }}</option>#}
{#                                {% endfor %}#}
{#                            </select>#}
            </div>


            <div class="tabs__" style="min-height: 400px" >
                <ul class="nav nav-tabs">
                    <li role="presentation" class="active"><a href="#general_info"    aria-controls="general" role="tab" data-toggle="tab">General</a></li>
                    <li role="presentation"class="">       <a href="#agenda"     aria-controls="agenda" role="tab" data-toggle="tab">Agenda</a></li>
                    <li role="presentation"class="">       <a href="#time_place" aria-controls="time_place" role="tab" data-toggle="tab">Time and Place</a></li>
                    <li role="presentation"class="">       <a href="#materials"  aria-controls="materials" role="tab" data-toggle="tab">Materials</a></li>
                </ul>

                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active" id="general_info">

                        <div class="form-group col-xs-8">
                            <label for="meeting_name">Name</label>
                            <input type="text" name="name" class="form-control" id="meeting_name" placeholder="My meeting"
                                   oninvalid="this.setCustomValidity('Please enter the name')" required>
                        </div>

                        <div class="form-group col-xs-4">
                            <label for="datetimepicker">Date</label>
                            <div class='input-group date' id='datetimepicker'>
                                <input name="date" type='text' class="form-control"
                                        required/>
                                <span class="input-group-addon">
                                    <span class="glyphicon glyphicon-calendar"></span>
                                </span>
                            </div>
                        </div>

                        <div class="form-group col-xs-8">
                                <label for="meeting_name">Purpose</label>
                                <input type="text" name="name" class="form-control" id="meeting_purpose" placeholder="Purpose of the Meeting"
                                       oninvalid="this.setCustomValidity('Please enter the name')" required>
                        </div>

                        <div class="col-xs-4">
                            <label for="progress">Add members</label>
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="Search for person...">
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="button">Add</button>
                                </span>
                            </div>
                        </div>

                        <div class="form-group col-xs-8">
                                <label for="meeting_name">Subject</label>
                                <input type="text" name="name" class="form-control" id="meeting_subject" placeholder="Identification of Subject matter"
                                        required>
                        </div>

                    </div> {#tab panel#}

                    <div role="tabpanel" class="tab-pane" id="agenda">
                        <div class="form-group">
            <hr>
            <h3>Agenda</h3>

            <div id="dynamicInput" class="form-group">
            </div>
            <button type="button" onclick="addInput('dynamicInput');" class="btn btn-info pull-right">Add item</button>
            <br>
        </div>
        <input type="submit" onclick="onSubmit()" value="Submit" class="btn btn-primary"/>
        <input type="hidden" id="agenda-elems" name="agenda"/>

                    </div>

                    <div role="tabpanel" class="tab-pane" id="time_place">
                        ...1.
                    </div>

                    <div role="tabpanel" class="tab-pane" id="materials">
                        materials
                    </div>
                </div>
            </div>
            <div class="text-right">
                <input type="submit" value="Submit" class="btn btn-primary"/>
            </div>
        </div>

    </form>

    <script type="text/javascript">
        var valeur = 0;
        var point = {"meeting_subject":false, "meeting_name":false, "meeting_purpose":false, "datetimepicker":false};
        var persent = 100 /  Object.keys(point).length;

        $("#datetimepicker").on("dp.change", function () {
            if (point['datetimepicker'] == false) {
                point['datetimepicker'] = true;
                valeur = valeur + persent;
                $('.progress-bar').css('width', valeur+'%').attr('aria-valuenow', valeur);
            }
        });

        $('input').on('input', function(){
            var SubkectElem = $(this).val();
            var id = this.id.toString()
               if ((SubkectElem  != "") && (point[id] == false))
               {
                   valeur = valeur + persent;
                   point[id] = true;
               }
               if (SubkectElem == "") {
                   valeur = valeur - persent;
                   point[id] = false;
               }
          $('.progress-bar').css('width', valeur+'%').attr('aria-valuenow', valeur).attr('val', valeur);
         });

        $(function () {
            $('#datetimepicker').datetimepicker();
        });
        var topicsCount = 0;
        var ids = [];
        function addInput(divName) {
            topicsCount++;
            var newdiv = document.createElement('div');
            newdiv.setAttribute('id', topicsCount);
            newdiv.setAttribute('class', 'input-group');
            ids.push(topicsCount);
            newdiv.innerHTML =
                    "<input type='text' class='form-control' placeholder='Topic'>" +
                    "<span class='input-group-btn'>" +
                    "<button type='button' class='btn btn-danger' onclick='removeElement("
                    + topicsCount + ")');'>Remove</button>" +
                    "</span>";
            document.getElementById(divName).appendChild(newdiv);
        }
        function removeElement(id) {
            var elem = document.getElementById(id);
            elem.parentNode.removeChild(elem);
            ids.remove(id);
        }
        function onSubmit() {
            var agendaInput = $("#agenda-elems");
            agendaInput.val("");
            $.each(ids, function (i, val) {
                var agendaElem = $("#dynamicInput").find("#" + val + " input").val();
                agendaInput.val(agendaInput.val() + '\n' + agendaElem);
            });
        }
        Array.prototype.remove = function () {
            var what, a = arguments, L = a.length, ax;
            while (L && this.length) {
                what = a[--L];
                while ((ax = this.indexOf(what)) !== -1) {
                    this.splice(ax, 1);
                }
            }
            return this;
        };
    </script>
{% endblock %}

{#        <div>#}
{##}
{#              <!-- Nav tabs -->#}
{#              <ul class="nav nav-tabs" role="tablist">#}
{#                <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">Home</a></li>#}
{#                <li role="presentation"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">Profile</a></li>#}
{#                <li role="presentation"><a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">Messages</a></li>#}
{#                <li role="presentation"><a href="#settings" aria-controls="settings" role="tab" data-toggle="tab">Settings</a></li>#}
{#              </ul>#}
{##}
{#              <!-- Tab panes -->#}
{#              <div class="tab-content">#}
{#                <div role="tabpanel" class="tab-pane active" id="home">.1..</div>#}
{#                <div role="tabpanel" class="tab-pane" id="profile">..2.</div>#}
{#                <div role="tabpanel" class="tab-pane" id="messages">3...</div>#}
{#                <div role="tabpanel" class="tab-pane" id="settings">.4..</div>#}
{#              </div>#}
{##}
{#        </div>#}